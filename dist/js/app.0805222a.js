(function(){"use strict";var t={2993:function(t,e,n){n(6133);var o=n(9242),i=n(3396);const r={class:"spreadBoard"},s={class:"editor"},u=(0,i._)("div",{class:"output-view-container"},[(0,i._)("div",{class:"output-view"}," Test ")],-1);function a(t,e){const n=(0,i.up)("ReteEditor"),o=(0,i.up)("ReteDock");return(0,i.wg)(),(0,i.iD)("div",r,[(0,i._)("div",s,[(0,i.Wm)(n),(0,i.Wm)(o)]),u])}var d=n(6520);const c={class:"rete",ref:"reteElm"};function p(t,e){return(0,i.wg)(),(0,i.iD)("div",c,null,512)}var l=n(4870),h=n(4306),v=n(4541),w=n(5443),m=n(869),g=n(7212),f=n(1329),y=n(2482);class Z{constructor(t){(0,y.Z)(this,"name",void 0),(0,y.Z)(this,"refSocket",void 0),(0,y.Z)(this,"valSocket",void 0),this.name=t,this.refSocket=new h.sk(t+" ref"),this.valSocket=new h.sk(t+" val")}}const k=new h.sk("type");class b{constructor(){(0,y.Z)(this,"types",void 0),this.types=new Map}add(t){t in this.types.keys()||this.types.set(t,new Z(t))}get(t){return this.types.get(t)}}const x=new b;x.add("text"),x.add("number"),x.add("boolean");const P=new h.ZP.Socket("act"),M=new h.ZP.Socket("String");x.get("number").valSocket.combineWith(M);class C extends h.ZP.Component{constructor(t){super("OutputComponent"),(0,y.Z)(this,"containerQuery",void 0),this.containerQuery=t}async builder(t){return t.addInput(new h.ZP.Input("in","",M)),t}worker(t,e,n){if(this.containerQuery){const t=document.querySelector(this.containerQuery);t&&(t.innerHTML=e["in"].length>0?e["in"][0]:"")}}}const O=["readonly","value"];function I(t,e,n,r,s,u){return(0,i.wg)(),(0,i.iD)("input",{type:"number",readonly:n.readonly,value:s.value,onInput:e[0]||(e[0]=t=>u.change(t)),onDblclick:e[1]||(e[1]=(0,o.iM)((()=>{}),["stop"])),onPointerdown:e[2]||(e[2]=(0,o.iM)((()=>{}),["stop"])),onPointermove:e[3]||(e[3]=(0,o.iM)((()=>{}),["stop"]))},null,40,O)}var S={props:["readonly","emitter","ikey","getData","putData"],name:"VueNumComponent",data(){return{value:0}},methods:{change(t){this.value=+t.target.value,this.update()},update(){this.ikey&&this.putData(this.ikey,this.value),this.emitter.trigger("process")}},mounted(){this.value=this.getData(this.ikey)}};(0,i.bv)((()=>{(void 0).value=(void 0).getData((void 0).ikey)}));var D=n(89);const V=(0,D.Z)(S,[["render",I]]);var E=V;class T extends h.ZP.Control{constructor(t,e,n=!1){super(e),(0,y.Z)(this,"component",void 0),(0,y.Z)(this,"props",void 0),this.component=E,this.props={emitter:t,ikey:e,readonly:n}}setValue(t){this.vueContext.value=t}}class N extends h.ZP.Component{constructor(){super("Add")}async builder(t){const e=new h.ZP.Input("num","Number",x.get("number").valSocket),n=new h.ZP.Input("num2","Number2",x.get("number").valSocket),o=new h.ZP.Output("num","Number",x.get("number").valSocket);e.addControl(new T(this.editor,"num",!1)),n.addControl(new T(this.editor,"num2",!1)),t.addInput(e).addInput(n).addControl(new T(this.editor,"preview",!0)).addOutput(o)}worker(t,e,n,...o){const i=e["num"].length?e["num"][0]:t.data.num,r=e["num2"].length?e["num2"][0]:t.data.num2,s=i+r,u=this.editor.nodes.find((e=>e.id==t.id)).controls.get("preview");u.setValue(s),n["num"]=s}}class R extends h.ZP.Component{constructor(){super("Number")}async builder(t){const e=new h.ZP.Output("num","Number",x.get("number").valSocket),n=new h.ZP.Output("type","Type",k);return t.addControl(new T(this.editor,"num",!1)).addOutput(e).addOutput(n)}worker(t,e,n){n["num"]=t.data.num}}const j=["readonly","value"];function _(t,e,n,r,s,u){return(0,i.wg)(),(0,i.iD)("input",{type:"text",readonly:n.readonly,value:s.value,onInput:e[0]||(e[0]=t=>u.change(t)),onDblclick:e[1]||(e[1]=(0,o.iM)((()=>{}),["stop"])),onPointerdown:e[2]||(e[2]=(0,o.iM)((()=>{}),["stop"])),onPointermove:e[3]||(e[3]=(0,o.iM)((()=>{}),["stop"]))},null,40,j)}var Q={props:["readonly","emitter","ikey","getData","putData"],name:"VueTextComponent",data(){return{value:""}},methods:{change(t){this.value=t.target.value,this.update()},update(){this.ikey&&this.putData(this.ikey,this.value),this.emitter.trigger("process")}},mounted(){this.value=this.getData(this.ikey)}};(0,i.bv)((()=>{(void 0).value=(void 0).getData((void 0).ikey),(void 0).value||((void 0).value="")}));const A=(0,D.Z)(Q,[["render",_]]);var B=A;class H extends h.ZP.Control{constructor(t,e,n=!1){super(e),(0,y.Z)(this,"component",void 0),(0,y.Z)(this,"props",void 0),this.component=B,this.props={emitter:t,ikey:e,readonly:n}}setValue(t){this.vueContext.value=t}}class J extends h.ZP.Component{constructor(){super("Text")}async builder(t){const e=new h.ZP.Output("txt","Text",M);return t.addControl(new H(this.editor,"txt",!1)).addOutput(e)}worker(t,e,n){n["txt"]=t.data.txt}}class W extends h.ZP.Component{constructor(){super("Text + Text")}async builder(t){const e=new h.ZP.Input("txt","Text",M),n=new h.ZP.Input("txt2","Text2",M),o=new h.ZP.Output("txt","Text",M);e.addControl(new H(this.editor,"txt",!1)),n.addControl(new H(this.editor,"txt2",!1)),t.addInput(e).addInput(n).addControl(new H(this.editor,"preview",!0)).addOutput(o)}worker(t,e,n,...o){let i=e["txt"].length?e["txt"][0]:t.data.txt;void 0==i&&(i="");let r=e["txt2"].length?e["txt2"][0]:t.data.txt2;void 0==r&&(r="");const s=i+""+r;return this.editor.nodes.find((e=>e.id==t.id)).controls.get("preview").setValue(s),n["txt"]=s,null}}class q extends h.ZP.Component{constructor(){super("Header")}async builder(t){const e=new h.ZP.Input("txt","Text",M),n=new h.ZP.Output("h","header",M);return e.addControl(new H(this.editor,"txt",!1)),t.addInput(e).addControl(new H(this.editor,"preview",!0)).addOutput(n)}worker(t,e,n){const o=e["txt"].length?e["txt"][0]:t.data.txt,i="<h1>"+o+"</h1>";this.editor.nodes.find((e=>e.id==t.id)).controls.get("preview").setValue(i),n["h"]=i}}class L{constructor(t){(0,y.Z)(this,"onChange",void 0),(0,y.Z)(this,"get",(()=>this.curValue)),this.onChange=t}set(t){this.curValue=t,this.edited=!0,this.onChange(t)}setInitial(t){this.initVal=t,this.edited||(this.curValue=t)}reset(){this.curValue=this.initVal,this.edited=!1}}class z extends h.ZP.Component{constructor(){super("Number - Variable"),(0,y.Z)(this,"variables",void 0),this.variables=new Map}async builder(t){const e=new h.ZP.Input("val","Initial Value",x.get("number").valSocket);e.addControl(new T(this.editor,"val")),this.variables.set(t.id,new L((e=>{t.update(),this.setPreview(t,e),this.editor.trigger("process")})));const n=new h.ZP.Output("ref","Reference",x.get("number").refSocket),o=new h.ZP.Output("val","Current Value",x.get("number").valSocket),i=new h.ZP.Output("type","Type",k);return t.addControl(new T(this.editor,"preview",!0)).addInput(e).addOutput(n).addOutput(o).addOutput(i)}setPreview(t,e){const n=t.controls.get("preview");n.setValue(e)}worker(t,e,n){const o=e["val"].length?e["val"][0]:t.data.val,i=this.variables.get(t.id);i.setInitial(o),this.setPreview(this.editor.nodes.find((e=>e.id==t.id)),i.get()),n["val"]=i.get(),n["ref"]=i,n["type"]="number"}}function F(t,e,n,o,r,s){return(0,i.wg)(),(0,i.iD)("button",{onClick:e[0]||(e[0]=t=>s.change(""))})}var G={props:["emitter","ikey"],name:"VueButtonComponent",methods:{change(t){this.emitter(t)}}};const K=(0,D.Z)(G,[["render",F]]);var U=K;class X extends h.ZP.Control{constructor(t,e){super(e),(0,y.Z)(this,"component",void 0),(0,y.Z)(this,"props",void 0),this.component=U,this.props={emitter:t,ikey:e}}}n(7658);class Y{constructor(){(0,y.Z)(this,"onEmits",new Map)}emit(t){for(const e of this.onEmits.values())e.call(t)}}class $ extends h.ZP.Component{constructor(t){super(t),(0,y.Z)(this,"emitterMap",void 0),(0,y.Z)(this,"listenerMap",void 0),(0,y.Z)(this,"inputMap",void 0),(0,y.Z)(this,"outputMap",void 0),(0,y.Z)(this,"nodeMap",void 0),this.listenerMap=new Map,this.emitterMap=new Map,this.inputMap=new Map,this.nodeMap=new Map,this.outputMap=new Map}worker(t,e,n){const o=this.editor.nodes.find((e=>e.id==t.id));this.listenerMap.get(t.id)&&this.listenerMap.get(t.id).forEach((e=>e.onEmits.delete(t.id))),this.listenerMap.set(t.id,[]);for(const i of o.inputs.keys())if(i.includes("act")){const n=e[i][0];n&&(console.log("Listening"),this.listenerMap.get(t.id).push(n),n.onEmits.set(t.id,(e=>this.run(t.id,e))))}for(const i of o.outputs.keys())i.includes("act")&&(this.emitterMap.get(t.id)||this.emitterMap.set(t.id,new Y),n[i]=this.emitterMap.get(t.id));return this.inputMap.set(t.id,e),this.outputMap.set(t.id,n),this.nodeMap.set(t.id,t),{node:t,inputs:e,outputs:n}}run(t,e){const n=this.nodeMap.get(t);this.editor.nodes.find((e=>e.id==t));this.task(n,this.inputMap.get(t),this.outputMap.get(t),e).then((e=>{this.emitterMap.get(t).emit(e)}))}}class tt extends ${constructor(){super("Button event")}async builder(t){t.addControl(new X((()=>{this.run(t.id,"onClick")}),"start")),t.addOutput(new h.ZP.Output("act","",P))}worker(t,e,n){const o=super.worker(t,e,n);t=o.node,e=o.inputs,n=o.outputs}async task(t,e,n,o){return n}}class et extends ${constructor(){super("Set Variable"),(0,y.Z)(this,"types",void 0),this.types=new Map}async builder(t){const e=new h.ZP.Input("type","Type",k),n=new h.ZP.Input("act","Action",P),o=new h.ZP.Output("act","Action",P);return t.addControl(new T(this.editor,"preview",!0)).addInput(e).addInput(n).addOutput(o)}worker(t,e,n){const o=super.worker(t,e,n);t=o.node,e=o.inputs,n=o.outputs,console.log("SetVar-Inputs",e);const i=e["type"][0];if(i==this.types.get(t.id))return;this.types.set(t.id,i);const r=this.editor.nodes.find((e=>e.id==t.id));r.inputs.get("ref")&&r.removeInput(r.inputs.get("ref")),r.inputs.get("val")&&r.removeInput(r.inputs.get("val")),r.addInput(new h.ZP.Input("ref","Reference",x.get(i).refSocket)),r.addInput(new h.ZP.Input("val","Reference",x.get(i).valSocket))}async task(t,e,n,o){const i=e["ref"][0],r=e["val"][0];return i&&r&&i.set(r),n}}async function nt(t){const e=new h.ZP.NodeEditor("demo@0.1.0",t),n=new h.ZP.Engine("demo@0.1.0");e.use(w.Z),e.use(v.Z),e.use(g.Z,{background:!1,snap:!1,scaleExtent:{min:.25,max:1},translateExtent:{width:5e3,height:4e3}});const o=new C(".output-view");e.register(o),n.register(o),e.use(m.ZP),e.use(f.Z,{container:document.querySelector(".dock"),plugins:[v.Z]});const i=[new N,new R,new J,new W,new q,new z,new tt,new et];for(let r=0;r<i.length;r++)e.register(i[r]),n.register(i[r]);await e.fromJSON({id:"demo@0.1.0",nodes:{1:{id:1,position:[100,50],name:"OutputComponent",inputs:null,outputs:null,data:null}}}),e.on(["connectioncreate","connectionremove","nodecreate","noderemove"],(t=>{console.log("editor something",t),console.log("editor",e.toJSON()),e.trigger("process")})),e.on("process",(async()=>{await n.abort(),await n.process(e.toJSON())})),e.view.resize()}var ot={name:"ReteEditor",setup(){const t=(0,l.iH)(null);return(0,i.bv)((()=>{nt(t.value)})),{reteElm:t}}};const it=(0,D.Z)(ot,[["render",p]]);var rt=it;const st={class:"dock"},ut=(0,i._)("h3",null,"Options",-1),at=[ut];function dt(t,e,n,o,r,s){return(0,i.wg)(),(0,i.iD)("div",st,at)}var ct={name:"ReteDock",setup(){}};const pt=(0,D.Z)(ct,[["render",dt]]);var lt,ht,vt=pt;let wt=(lt=(0,d.Ei)({components:{ReteEditor:rt,ReteDock:vt}}),lt(ht=class extends d.w3{})||ht);const mt=(0,D.Z)(wt,[["render",a]]);var gt=mt;(0,o.ri)(gt).mount("#app")}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,n),r.exports}n.m=t,function(){var t=[];n.O=function(e,o,i,r){if(!o){var s=1/0;for(c=0;c<t.length;c++){o=t[c][0],i=t[c][1],r=t[c][2];for(var u=!0,a=0;a<o.length;a++)(!1&r||s>=r)&&Object.keys(n.O).every((function(t){return n.O[t](o[a])}))?o.splice(a--,1):(u=!1,r<s&&(s=r));if(u){t.splice(c--,1);var d=i();void 0!==d&&(e=d)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[o,i,r]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var i,r,s=o[0],u=o[1],a=o[2],d=0;if(s.some((function(e){return 0!==t[e]}))){for(i in u)n.o(u,i)&&(n.m[i]=u[i]);if(a)var c=a(n)}for(e&&e(o);d<s.length;d++)r=s[d],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(c)},o=self["webpackChunkspreadboard"]=self["webpackChunkspreadboard"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(2993)}));o=n.O(o)})();
//# sourceMappingURL=app.0805222a.js.map