(function(){"use strict";var t={3484:function(t,e,n){n(6133);var o=n(9242),i=n(3396);const r={class:"spreadBoard"},s={class:"editor"},a=(0,i._)("div",{class:"output-view-container"},[(0,i._)("div",{class:"output-view"}," Test ")],-1);function u(t,e){const n=(0,i.up)("ReteEditor"),o=(0,i.up)("ReteDock");return(0,i.wg)(),(0,i.iD)("div",r,[(0,i._)("div",s,[(0,i.Wm)(n),(0,i.Wm)(o)]),a])}var d=n(6520);const c={class:"rete",ref:"reteElm"};function l(t,e){return(0,i.wg)(),(0,i.iD)("div",c,null,512)}var p=n(4870),v=n(4306),h=n(4541),g=n(5443),m=n(869),w=n(7212),f=n(1329),k=n(2482);class y{constructor(t){(0,k.Z)(this,"name",void 0),(0,k.Z)(this,"refSocket",void 0),(0,k.Z)(this,"valSocket",void 0),this.name=t,this.refSocket=new v.sk(t+" ref"),this.valSocket=new v.sk(t+" val")}}const Z=new v.sk("type"),b=new y("any");class x{constructor(){(0,k.Z)(this,"types",void 0),this.types=new Map}add(t){if(!(t in this.types.keys())){const e=new y(t);this.types.set(t,e),e.refSocket.combineWith(b.refSocket),e.valSocket.combineWith(b.valSocket)}}getRefByVal(t){return this.get(t.name.replace(" val","")).refSocket}getValByRef(t){return this.get(t.name.replace(" ref","")).valSocket}get(t){return this.types.get(t)}}const P=new x;P.add("text"),P.add("number"),P.add("boolean");const V=new v.ZP.Socket("act");P.get("number").valSocket.combineWith(P.get("text").valSocket);const C={val:"Wert",ref:"Variable",num:"Zahl",addIn:"Summand",act:"Aktion",txt:"Text",add:"Addiere",res:"Ergebnis",curVal:"Aktueller Wert",initVal:"Startwert",setVar:"Setze Variable",trigger:"Auslöser",header:"Überschrift",combine:"Zusammenfügen",numVar:"Variable:\nZahl",type:"Datentyp",view:"Anzeige",wait:"Warten",curTime:"Verbleibende Zeit",initTime:"Start-Zeit"},S={de:C};var I=S;class O extends v.ZP.Component{constructor(t){super(I.de.view),(0,k.Z)(this,"containerQuery",void 0),this.containerQuery=t}async builder(t){return t.addInput(new v.ZP.Input("in","",P.get("text").valSocket)),t}worker(t,e,n){if(this.containerQuery){const t=document.querySelector(this.containerQuery);t&&(t.innerHTML=e["in"][0]?e["in"][0]:"")}}}var D=n(7139);const _={class:"control title"},M=["readonly","value"];function E(t,e,n,r,s,a){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",_,(0,D.zw)(n.title?n.title+":":""),1),(0,i._)("input",{type:"number",readonly:n.readonly,value:s.value,onInput:e[0]||(e[0]=t=>a.change(t)),onDblclick:e[1]||(e[1]=(0,o.iM)((()=>{}),["stop"])),onPointerdown:e[2]||(e[2]=(0,o.iM)((()=>{}),["stop"])),onPointermove:e[3]||(e[3]=(0,o.iM)((()=>{}),["stop"]))},null,40,M)],64)}var R={props:["readonly","emitter","ikey","getData","putData","title"],name:"VueNumComponent",data(){return{value:0}},methods:{change(t){this.value=+t.target.value,this.update()},update(){this.ikey&&this.putData(this.ikey,this.value),this.emitter("process",this.value)}},mounted(){this.value=this.getData(this.ikey)}};(0,i.bv)((()=>{(void 0).value=(void 0).getData((void 0).ikey)}));var T=n(89);const W=(0,T.Z)(R,[["render",E],["__scopeId","data-v-44009e5a"]]);var j=W;class A extends v.ZP.Control{constructor(t,e,n=!1,o=null){super(e),(0,k.Z)(this,"component",void 0),(0,k.Z)(this,"props",void 0),this.component=j,this.props={emitter:t,ikey:e,readonly:n,title:o}}setValue(t){this.vueContext.value=t}getValue(){return this.vueContext.value}}class B extends v.ZP.Component{constructor(){super(I.de.add)}async builder(t){const e=new v.ZP.Input("num",I.de.addIn,P.get("number").valSocket),n=new v.ZP.Input("num2",I.de.addIn,P.get("number").valSocket),o=new v.ZP.Output("num",I.de.res,P.get("number").valSocket);e.addControl(new A(((t,e)=>lt.trigger(t)),"num",!1,I.de.addIn)),n.addControl(new A(((t,e)=>lt.trigger(t)),"num2",!1,I.de.addIn)),t.addInput(e).addInput(n).addControl(new A(((t,e)=>{}),"preview",!0,I.de.res)).addOutput(o)}worker(t,e,n,...o){const i=e["num"].length?e["num"][0]:t.data.num,r=e["num2"].length?e["num2"][0]:t.data.num2,s=i+r,a=lt.nodes.find((e=>e.id==t.id)).controls.get("preview");a.setValue(s),n["num"]=s}}class z extends v.ZP.Component{constructor(){super(I.de.num)}async builder(t){const e=new v.ZP.Output("num",I.de.num,P.get("number").valSocket);return t.addControl(new A(((t,e)=>lt.trigger(t)),"num",!1)).addOutput(e)}worker(t,e,n){n["num"]=t.data.num}}const N={class:"title control"},H=["readonly","value"];function L(t,e,n,r,s,a){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",N,(0,D.zw)(n.title?n.title+":":""),1),(0,i._)("input",{type:"text",readonly:n.readonly,value:s.value,onInput:e[0]||(e[0]=t=>a.change(t)),onDblclick:e[1]||(e[1]=(0,o.iM)((()=>{}),["stop"])),onPointerdown:e[2]||(e[2]=(0,o.iM)((()=>{}),["stop"])),onPointermove:e[3]||(e[3]=(0,o.iM)((()=>{}),["stop"]))},null,40,H)],64)}var Q={props:["readonly","emitter","ikey","getData","putData","title"],name:"VueTextComponent",data(){return{value:""}},methods:{change(t){this.value=t.target.value,this.update()},update(){this.ikey&&this.putData(this.ikey,this.value),this.emitter.trigger("process")}},mounted(){this.value=this.getData(this.ikey)}};(0,i.bv)((()=>{(void 0).value=(void 0).getData((void 0).ikey),(void 0).value||((void 0).value="")}));const J=(0,T.Z)(Q,[["render",L],["__scopeId","data-v-26f6d556"]]);var q=J;class Y extends v.ZP.Control{constructor(t,e,n=!1,o=null){super(e),(0,k.Z)(this,"component",void 0),(0,k.Z)(this,"props",void 0),this.component=q,this.props={emitter:t,ikey:e,readonly:n,title:o}}setValue(t){this.vueContext.value=t}}class F extends v.ZP.Component{constructor(){super(I.de.txt)}async builder(t){const e=new v.ZP.Output("txt",I.de.txt,P.get("text").valSocket);return t.addControl(new Y(lt,"txt",!1)).addOutput(e)}worker(t,e,n){n["txt"]=t.data.txt}}class G extends v.ZP.Component{constructor(){super(I.de.combine)}async builder(t){const e=new v.ZP.Input("txt",I.de.txt,P.get("text").valSocket),n=new v.ZP.Input("txt2",I.de.txt,P.get("text").valSocket),o=new v.ZP.Output("txt",I.de.res,P.get("text").valSocket);e.addControl(new Y(lt,"txt",!1)),n.addControl(new Y(lt,"txt2",!1)),t.addInput(e).addInput(n).addControl(new Y(lt,"preview",!0)).addOutput(o)}worker(t,e,n,...o){let i=e["txt"].length?e["txt"][0]:t.data.txt;void 0==i&&(i="");let r=e["txt2"].length?e["txt2"][0]:t.data.txt2;void 0==r&&(r="");const s=i+""+r;return lt.nodes.find((e=>e.id==t.id)).controls.get("preview").setValue(s),n["txt"]=s,null}}class K extends v.ZP.Component{constructor(){super(I.de.header)}async builder(t){const e=new v.ZP.Input("txt",I.de.txt,P.get("text").valSocket),n=new v.ZP.Output("h",I.de.header,P.get("text").valSocket);return e.addControl(new Y(lt,"txt",!1)),t.addInput(e).addControl(new Y(lt,"preview",!0)).addOutput(n)}worker(t,e,n){const o=e["txt"].length?e["txt"][0]:t.data.txt,i="<h1>"+o+"</h1>";lt.nodes.find((e=>e.id==t.id)).controls.get("preview").setValue(i),n["h"]=i}}class U{constructor(t){(0,k.Z)(this,"onChange",void 0),(0,k.Z)(this,"getEdited",(()=>this.edited)),(0,k.Z)(this,"get",(()=>this.curValue)),this.onChange=t}set(t){const e=this.curValue;this.curValue=t,e!=this.curValue&&(this.edited=!0,this.onChange(t))}setInitial(t){const e=this.curValue;this.initVal=t,this.edited||(this.curValue=t,e!=this.curValue&&this.onChange(t))}reset(){const t=this.curValue;this.curValue=this.initVal,this.edited=!1,this.curValue!=t&&this.onChange(this.curValue)}}class X extends v.ZP.Component{constructor(){super(I.de.numVar),(0,k.Z)(this,"variables",void 0),this.variables=new Map}async builder(t){const e=new A(((t,e)=>{lt.trigger(t)}),"curVal",!0,I.de.curVal),n=new U((n=>{console.log("Value Changed"),e.setValue(n),t.update(),lt.trigger("process")})),o=new v.ZP.Input("init",I.de.initVal,P.get("number").valSocket);o.addControl(new A(((t,e)=>{n.setInitial(e)}),"init",!1,I.de.val)),this.variables.set(t.id,n);const i=new v.ZP.Output("ref",I.de.ref,P.get("number").refSocket),r=new v.ZP.Output("val",I.de.curVal,P.get("number").valSocket),s=new v.ZP.Output("type",I.de.type,Z);return t.addControl(e).addInput(o).addOutput(s).addOutput(i).addOutput(r)}setPreview(t,e){const n=t.controls.get("curVal");n&&n.setValue(e)}worker(t,e,n){const o=e["init"].length?e["init"][0]:t.data.init,i=this.variables.get(t.id);i.setInitial(o);const r=lt.nodes.find((e=>e.id==t.id));this.setPreview(r,i.get()),n["val"]=i.get(),n["ref"]=i,n["type"]="number"}}function $(t,e,n,o,r,s){return(0,i.wg)(),(0,i.iD)("button",{onClick:e[0]||(e[0]=t=>s.change(""))})}var tt={props:["emitter","ikey"],name:"VueButtonComponent",methods:{change(t){this.emitter(t)}}};const et=(0,T.Z)(tt,[["render",$],["__scopeId","data-v-0e180730"]]);var nt=et;class ot extends v.ZP.Control{constructor(t,e){super(e),(0,k.Z)(this,"component",void 0),(0,k.Z)(this,"props",void 0),this.component=nt,this.props={emitter:t,ikey:e}}}class it{constructor(){(0,k.Z)(this,"listeners",new Map),this.listeners}on(t,e,n){for(const o of t)this.listeners.get(o)||this.listeners.set(o,new Map),this.listeners.get(o).set(e,n)}removeListener(t){for(const e of this.listeners.keys())this.listeners.get(e)&&this.listeners.get(e).delete(t)}trigger(t,...e){if(this.listeners.get(t))for(const n of this.listeners.get(t).values())n(t,e)}}const rt=new it;var st=rt;class at extends v.ZP.Component{constructor(){super(I.de.trigger)}async builder(t){t.addControl(new ot((()=>{st.trigger(t.id+"-onClick")}),"start")),t.addOutput(new v.ZP.Output("act","",V))}worker(t,e,n){n["act"]=t.id+"-onClick"}}class ut extends v.ZP.Component{constructor(){super(I.de.setVar),(0,k.Z)(this,"types",void 0),this.types=new Map}async builder(t){const e=new v.ZP.Input("ref",I.de.ref,b.refSocket),n=new v.ZP.Input("val",I.de.val,b.valSocket),o=new v.ZP.Input("act",I.de.act,V),i=new v.ZP.Output("act",I.de.act,V);return t.addInput(e).addInput(n).addInput(o).addOutput(i)}worker(t,e,n){st.removeListener(t.id);const o=this.editor.nodes.find((e=>e.id==t.id)),i=o.getConnections().find(((t,e)=>"ref"==t.input.key)),r=o.getConnections().find(((t,e)=>"val"==t.input.key));i&&i.output.socket&&r&&r.output.socket&&r.output.socket!=P.getValByRef(i.output.socket)?r.remove():i&&i.output.socket?o.inputs.get("val").socket=P.getValByRef(i.output.socket):r&&r.output.socket&&(o.inputs.get("ref").socket=P.getRefByVal(r.output.socket)),n["act"]=t.id+"",st.on([e["act"][0]],t.id,((n,...o)=>{this.task(t,e)}))}async task(t,e){const n=e["ref"][0],o=e["val"][0];n&&null!=o&&n.set(o)}}class dt extends v.ZP.Component{constructor(){super(I.de.wait),(0,k.Z)(this,"variables",new Map)}async builder(t){const e=new A(((t,e)=>{}),"preview",!0),n=new v.ZP.Input("val",I.de.initTime,P.get("number").valSocket),o=new U((t=>{e.setValue(Math.round(t)),lt.trigger("process")}));return n.addControl(new A(((t,e)=>o.setInitial(e)),"val",!1)),this.variables.set(t.id,o),t.addInput(n).addControl(e).addOutput(new v.ZP.Output("act","",V)).addInput(new v.ZP.Input("act","",V))}worker(t,e,n){st.removeListener(t.id);lt.nodes.find((e=>e.id==t.id));const o=this.variables.get(t.id),i=e["val"].length?e["val"][0]:t.data.val;n["act"]=t.id+"",o.setInitial(i),st.on([e["act"][0]],t.id,((n,...o)=>{this.task(t,e)}))}delay(t){return new Promise((e=>setTimeout(e,t)))}async task(t,e){console.log("Try Waiting");const n=this.variables.get(t.id);if(n.getEdited())return void n.reset();let o=Date.now(),i=o;while(n.get()>0)console.log("Waiting"),i=Date.now(),n.set(n.get()-(i-o)/1e3),o=i,await this.delay(1e3);n.reset(),n.set(n.get()),st.trigger(t.id+"")}}const ct={id:"demo@0.1.0",nodes:{10:{id:10,data:{},inputs:{ref:{connections:[{node:13,output:"ref",data:{}}]},val:{connections:[{node:14,output:"num",data:{}}]},act:{connections:[{node:11,output:"act",data:{}}]}},outputs:{act:{connections:[]}},position:[867,86],name:"Setze Variable"},11:{id:11,data:{val:10},inputs:{val:{connections:[]},act:{connections:[{node:12,output:"act",data:{}}]}},outputs:{act:{connections:[{node:10,input:"act",data:{}}]}},position:[501.14351757786164,268.11481406228927],name:"Warten"},12:{id:12,data:{},inputs:{},outputs:{act:{connections:[{node:11,input:"act",data:{}}]}},position:[153,431],name:"Auslöser"},13:{id:13,data:{init:0},inputs:{init:{connections:[]}},outputs:{type:{connections:[]},ref:{connections:[{node:10,input:"ref",data:{}}]},val:{connections:[{node:14,input:"num",data:{}}]}},position:[-289.6739280630984,-22.75085348483225],name:"Variable:\nZahl"},14:{id:14,data:{num2:1},inputs:{num:{connections:[{node:13,output:"val",data:{}}]},num2:{connections:[]}},outputs:{num:{connections:[{node:10,input:"val",data:{}}]}},position:[107.1480995362083,128.06772349810535],name:"Addiere"}}};let lt=null;async function pt(t){lt=new v.ZP.NodeEditor("demo@0.1.0",t);const e=new v.ZP.Engine("demo@0.1.0");lt.use(g.Z),lt.use(h.Z),lt.use(w.Z,{background:!1,snap:!1,scaleExtent:{min:.25,max:1},translateExtent:{width:5e3,height:4e3}});const n=new O(".output-view");lt.register(n),e.register(n),lt.use(m.ZP),lt.use(f.Z,{container:document.querySelector(".dock"),plugins:[h.Z]});const o=[new B,new z,new F,new G,new K,new X,new at,new ut,new dt];for(let i=0;i<o.length;i++)lt.register(o[i]),e.register(o[i]);await lt.fromJSON(ct),lt.on(["connectioncreate","connectionremove","nodecreate","noderemove"],(t=>{lt.trigger("process")})),lt.on("process",(async()=>{console.log("json",lt.toJSON()),await e.abort(),await e.process(lt.toJSON())})),lt.view.resize()}var vt={name:"ReteEditor",setup(){const t=(0,p.iH)(null);return(0,i.bv)((()=>{pt(t.value)})),{reteElm:t}}};const ht=(0,T.Z)(vt,[["render",l]]);var gt=ht;const mt={class:"dock"},wt=(0,i._)("h3",null,"Options",-1),ft=[wt];function kt(t,e,n,o,r,s){return(0,i.wg)(),(0,i.iD)("div",mt,ft)}var yt={name:"ReteDock",setup(){}};const Zt=(0,T.Z)(yt,[["render",kt]]);var bt,xt,Pt=Zt;let Vt=(bt=(0,d.Ei)({components:{ReteEditor:gt,ReteDock:Pt}}),bt(xt=class extends d.w3{})||xt);const Ct=(0,T.Z)(Vt,[["render",u]]);var St=Ct;(0,o.ri)(St).mount("#app")}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,n),r.exports}n.m=t,function(){var t=[];n.O=function(e,o,i,r){if(!o){var s=1/0;for(c=0;c<t.length;c++){o=t[c][0],i=t[c][1],r=t[c][2];for(var a=!0,u=0;u<o.length;u++)(!1&r||s>=r)&&Object.keys(n.O).every((function(t){return n.O[t](o[u])}))?o.splice(u--,1):(a=!1,r<s&&(s=r));if(a){t.splice(c--,1);var d=i();void 0!==d&&(e=d)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[o,i,r]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var i,r,s=o[0],a=o[1],u=o[2],d=0;if(s.some((function(e){return 0!==t[e]}))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(u)var c=u(n)}for(e&&e(o);d<s.length;d++)r=s[d],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(c)},o=self["webpackChunkspreadboard"]=self["webpackChunkspreadboard"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(3484)}));o=n.O(o)})();
//# sourceMappingURL=app.f532a297.js.map